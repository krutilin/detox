language: node_js
node_js:
  - 8
sudo: false
env:
  - NODE_ENV='test'

matrix:
  include:
    - language: objective-c
      os: osx
      osx_image: xcode9.2
      before_install:
        - nvm install 7
        - node --version
      install:
        - brew tap wix/brew
        - brew install applesimutils
        - npm install -g detox-cli
        - npm install -g react-native-cli
        - npm i
      script:      
        - react-native start --port 2137 &
        - detox build -c ios.sim.debug 
        - detox test -c ios.sim.debug
        - kill -9 $(lsof -n -i4TCP:2137)        